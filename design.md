# AMGX 调用与求解功能说明

以下是对代码中各个文件功能的说明，基于 AMGX 库的调用和求解流程。

## 核心功能文件

### `amgx_solver.cpp`
提供了一个封装的函数 `run_amgx_solver()`，用于初始化 AMGX 库、创建资源、配置求解器、上传矩阵和向量数据、执行求解并下载结果。

主要功能：
- 初始化 AMGX 库。
- 创建 AMGX 资源和配置。
- 构造矩阵和向量（CSR 格式）。
- 调用 AMGX 求解器进行线性方程组求解。
- 清理资源。

### `amgx_solver.h`
定义了 `run_amgx_solver()` 函数的接口，供其他文件调用。

---

## 测试文件

### `test.cpp`
提供了一个简单的 AMGX 求解器示例，展示了如何使用 AMGX 库解决线性方程组。

主要功能：
- 初始化 AMGX 库。
- 使用配置字符串创建求解器。
- 构造矩阵和向量。
- 调用求解器并输出结果。

### `amgx_test.cpp`
测试 AMGX 求解器的功能，类似于 `test.cpp`，但更注重不同配置的测试。

主要功能：
- 使用 GMRES 求解器配置。
- 测试不同的矩阵和向量上传方式。
- 验证求解器的正确性。

### `par_test*.cpp`
包含多个并行测试文件（如 `par_test1.cpp` 到 `par_test5.cpp`），用于测试 AMGX 在 MPI 并行环境下的功能。

主要功能：
- 初始化 MPI 通信。
- 创建分布式矩阵和向量。
- 测试 AMGX 的分布式求解功能。
- 验证通信映射和分布式矩阵上传。

### `diagonal_test.cpp`
测试对角矩阵的求解，验证 AMGX 在特定矩阵结构下的性能和正确性。

### `json.cpp`
测试从 JSON 配置文件加载 AMGX 配置的功能。

主要功能：
- 从 JSON 文件加载求解器配置。
- 测试 AMGX 求解器的初始化和求解流程。

---

## 配置和库文件

### `install/include/amgx_c.h`
AMGX 的 C 语言 API 头文件，定义了所有 AMGX 库的函数、枚举和数据结构。

主要功能：
- 提供 AMGX 库的接口，例如矩阵上传、求解器创建、资源管理等。

### `install/include/amgx_config.h`
定义了 AMGX 的配置选项和模式，例如内存空间、数据精度、矩阵和向量格式等。

### `CMakeLists.txt`
配置 CMake 构建系统，定义如何编译和链接 AMGX 相关的测试程序。

主要功能：
- 设置 AMGX 库的路径。
- 添加测试程序的构建规则。
- 确保动态库（如 `amgxsh.dll`）被正确复制到输出目录。

---

## 动态加载文件

### `camgx.cpp`
提供了动态加载 AMGX 库的功能，避免直接链接 AMGX 库。

主要功能：
- 使用 Windows API 加载 `amgxsh.dll`。
- 动态解析 AMGX 函数地址。
- 测试 AMGX 求解器功能。

---

## 其他文件

### `design.md`
用于记录项目的设计文档，可能包含 AMGX 调用的设计思路、测试计划或使用说明。

### `testcout.cpp`
一个简单的测试文件，用于验证 AMGX 库的初始化和释放是否正常。

---

## 总结

这些文件共同完成了以下任务：
1. **AMGX 库的初始化和配置**：通过 `amgx_solver.cpp` 和测试文件实现。
2. **矩阵和向量的上传**：测试文件展示了不同的上传方式（如全局矩阵和分布式矩阵）。
3. **求解器的调用和结果下载**：通过调用 AMGX API 实现。
4. **并行计算支持**：通过 MPI 测试文件验证 AMGX 在分布式环境下的功能。
5. **动态加载支持**：通过 `camgx.cpp` 实现动态加载 AMGX 库的功能。
6. **测试和验证**：多个测试文件验证 AMGX 的功能和性能。